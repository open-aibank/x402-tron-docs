# 钱包

在 x402-tron 中，TRON 钱包既是支付机制，也是买家和卖家的唯一身份形式。钱包地址用于发送、接收和验证支付，同时也作为协议内的标识符。

## 钱包的角色

### 对于买家

买家使用 TRON 钱包来：

- 存储 USDT/TRC-20 代币
- 签署 TIP-712 支付负载
- 以编程方式授权链上支付
- 管理促进者的代币授权

钱包使买家（包括 AI 代理）能够在无需创建账户或凭证管理的情况下进行交易。

### 对于卖家

卖家使用 TRON 钱包来：

- 接收 USDT/TRC-20 支付
- 在服务器配置中定义其支付目标

卖家的 TRON 钱包地址包含在提供给买家的支付要求中。

## TRON 钱包地址

TRON 使用以 'T' 开头的 base58 编码地址。例如：

```
TDhj8uX7SVJwvhCUrMaiQHqPgrB6wRb3eG
```

## TIP-712 签名

x402-tron 使用 TIP-712（TRON 对 EIP-712 的实现）进行结构化数据签名。这提供了：

- **人类可读的签名**：用户可以看到他们正在授权的内容
- **域分离**：签名绑定到特定的合约/域
- **重放保护**：签名包含随机数和过期时间

签名流程：

1. 客户端从服务器接收支付要求
2. 客户端构建 TIP-712 类型数据结构
3. 客户端使用其私钥签署数据
4. 签名包含在 PAYMENT-SIGNATURE 头中

## 代币授权

对于 exact 支付方案，客户端必须批准促进者代表其支出代币。这通过标准的 TRC-20 approve 函数完成。

## 网络特定端点

每个网络的 TRON 全节点 / API 端点：

| 网络 | 端点 |
|------|------|
| 主网 | https://api.trongrid.io |
| Nile（测试网） | https://nile.trongrid.io |
| Shasta（测试网） | https://api.shasta.trongrid.io |

## 安全最佳实践

- **永远不要暴露私钥**：使用环境变量存储密钥
- **使用测试网进行开发**：在主网之前在 Nile 或 Shasta 上测试
- **限制授权**：仅批准支付所需的金额
- **监控交易**：在 TronScan 上跟踪支付和授权

## 总结

- TRON 钱包在 x402-tron 中实现程序化、无需许可的支付
- 买家使用钱包通过 TIP-712 签名授权支付服务费用
- 卖家使用钱包接收支付
- 钱包地址也充当协议内的唯一标识符
- SDK 自动处理代币授权
